---
description: Ultrawork 模式 - 完整自動化任務執行流程（含 Enforcer 和 Ralph Loop）
---

# Ultrawork 模式工作流程

當用戶提及 `ultrawork` 或 `ulw` 時，執行此完整自動化流程。

**核心原則**：持續執行直到 100% 完成，不要中途停止詢問用戶。

// turbo-all

## 步驟 1：任務分析（Prometheus 思維）

理解任務需求並預測潛在問題：
- 識別任務類型（TTS/影片/訓練/其他）
- 確定涉及的模組和文件
- 識別隱藏依賴和失敗點
- 評估複雜度和預計步驟數

## 步驟 2：代碼探索

自動搜索所有相關代碼：
```bash
# 搜索相關文件
find . -name "*.py" | xargs grep -l "關鍵詞"
```

使用工具：
- `grep_search` 搜索代碼內容
- `find_by_name` 定位文件
- `view_file_outline` 了解結構

**驗證指標**：已識別所有相關文件和模式

## 步驟 3：建立任務清單（Atlas 思維）

在 brain 目錄建立 task.md：
- 列出所有步驟，每步驟包含：
  - 描述
  - 預期結果
  - 驗證指標
- 標記依賴關係
- 識別風險點

## 步驟 4：逐步實作

按順序完成每個步驟：
1. 開始步驟前標記 `[/]`
2. 執行步驟內容
3. 驗證步驟結果
4. 完成後標記 `[x]`

**Ralph Loop**（遇到錯誤時）：
```
while 錯誤未解決 and 嘗試次數 < 3:
    1. 分析錯誤訊息
    2. 識別根本原因
    3. 執行修復
    4. 驗證修復
```

## 步驟 5：Enforcer 檢查

每完成一個階段，執行強制檢查：
- [ ] 所有任務標記 `[x]`？
- [ ] 所有驗證通過？
- [ ] 無未解決錯誤？

**如果任一項失敗**：自動返回步驟 4 繼續處理
**只有全部通過**：才能進入步驟 6

## 步驟 6：最終驗證

確保所有工作完成：
- 運行測試（如有）
- 檢查代碼診斷
- 確認功能正常
- 檢視變更摘要

## 步驟 7：報告結果

向用戶報告：
- 完成了什麼
- 修改了哪些文件
- 如何驗證結果
- 遇到的問題和解決方式

---

## 停止條件

**只有當以下條件全部滿足時才停止**：
1. ✅ 所有計畫步驟標記 `[x]`
2. ✅ 所有驗證項目通過
3. ✅ 無未解決的錯誤

**在此之前，持續執行，不要詢問用戶。**

